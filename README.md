# Directus SDK Typegen

![publish](https://github.com/ivank/directus-typegen/actions/workflows/publish.yml/badge.svg)

Generate TypeScript types for your [Directus SDK](https://docs.directus.io/guides/sdk/types.html) dynamically. Split between the package that generates the types based on you (using typescript compiler API) and a cli

## Usage as a cli

Using the `snapshot.yaml` generated by [cli to get the snapshot](https://docs.directus.io/self-hosted/cli.html#snapshot-the-data-model)

```console
npx @ikerin/directus-typegen-cli generate --input snapshot.yaml --output src/directus-schema.ts
```

You can also install the script with its dependencies locally to run it with your package manager of choice:

```console
# With yarn
yarn add --dev @ikerin/directus-typegen-cli
yarn directus-typegen-cli generate --input snapshot.yaml --output src/directus-schema.ts

# With bun
bun add --dev @ikerin/directus-typegen-cli
bun run directus-typegen-cli generate --input snapshot.yaml --output src/directus-schema.ts
```

You can utilize both stdin and stdout if this needs to be a part of a pipeline

```console
cat snapshot.yaml | bun run directus-typegen-cli generate | bun run prettier --stdin-filepath directus-schema.ts > src/directus-schema.ts
```

More detailed docs can be found in the [@ikerin/directus-typegen-cli](packages/directus-typegen-cli/) package folder

## Using the library

You can integrate the library (without the CLI dependencies) in you extensions.

```console
bun add @ikerin/directus-typegen
```

> [simple.ts](packages/directus-typegen/examples/simple.ts)

```typescript
import { generateTypesFromSnapshot } from '@ikerin/directus-typegen';
import { readFileSync } from 'fs';
import { join } from 'path';

// Get the contents of the snapshot
// We are using JSON for simplicity, usually you will use YAML
const snapshotPath = join(import.meta.dirname, 'snapshot.json');
const snapshot = JSON.parse(readFileSync(snapshotPath, 'utf-8'));

// This is the core of the operation
const types = generateTypesFromSnapshot(snapshot);

console.log(types);
```

More explanations in the package itself [@ikerin/directus-typegen](packages/directus-typegen/)
